# WorkHistory 작성 가이드

## 핵심 원칙
**"필요한 깊이만 로드"** - 계층적 구성으로 최소 토큰으로 전체 그림 파악, 필요할 때만 deep dive.

## 폴더 구조

```
~/WorkHistory/
├── _index.md          # 전체 인덱스 (항상 먼저 확인)
├── topics/            # 모든 지식과 작업 기록
│   ├── pbb/           # PBB 프로젝트
│   ├── pubg/          # PUBG 본가
│   ├── pubg2/         # PUBG2
│   ├── ctu-example/   # CTU_Example (CSS는 PUBG2와 공통)
│   ├── tools/         # 프로젝트 무관 도구 (claude-agent 등)
│   ├── research/      # 외부 기술 리서치
│   └── unreal-mcp/    # Unreal MCP 서버
├── daily/             # 날짜별 일일 로그
└── context/           # 장기 컨텍스트 (이 가이드, 프로젝트 정의 등)
```

## topics/ 구조 규칙

**단순 주제** → 단일 파일:
```
topics/{project}/{topic}.md
```

**복잡한 시스템** → 디렉토리 + 평탄한 파일:
```
topics/{project}/{system}/
├── _index.md                    # 핵심 요약 + 구조: 시스템 설명, 진척, TODO, 파일 목록
├── architecture.md              # 아키텍처, 클래스 관계
├── {주제별-파일}.md              # 분석, 흐름, 작업 기록 등 (타입 구분 없이 내용 기준 이름)
├── P2-12345.md                  # Jira 티켓은 번호가 식별자
└── snippets/                    # 코드 발췌 (필요 시)
```

**핵심**: task/topic 구분 없음. 분석이든 작업이든 해당 시스템 폴더에 평탄하게 저장.

## 문서 깊이 단계

| 단계 | 이름 | 용도 | 예시 |
|------|------|------|------|
| 1 | **핵심 요약** | 2-3줄. 모든 파일 최상단 필수 | `> CSS는 장비 메시를 머지하는 시스템` |
| 2 | **구조** | 클래스 관계, 모듈, 흐름 요약 | 테이블, 한줄 콜체인 |
| 3 | **상세** | 호출 흐름, 분기 조건, 클래스 멤버 | 코드 분석, 분기 표 |
| 4 | **코드** | 핵심 코드 발췌 + 파일:라인 | snippets/ |

읽는 전략: 핵심 요약만 → 전체 파악 (5초), 구조까지 → 큰 그림 (30초), 상세까지 → 동작 이해 (수 분)

## 문서 작성 순서

모든 .md 파일:
```markdown
# {제목}

> {핵심 요약: 2-3줄. 이것만 읽으면 "이게 뭔지" 알 수 있어야 함}

## 구조
{테이블, 짧은 리스트, 클래스 관계}

## 상세
{호출 흐름, 분기 조건 등}

## 코드
{코드 발췌 + 파일:라인}
```

## _index.md 작성 규칙

```markdown
# {시스템명}

> {한줄 설명}

## 핵심 요약
{2-3줄}

## 진행 상태
- [x] 완료 항목
- [ ] TODO 항목

## 문서 구성
| 파일 | 설명 |
|------|------|
| architecture.md | 클래스 관계, 모듈 |
| xxx.md | xxx 설명 |

## 검색 키워드
{grep 검색용}
```

## 흐름 분석 템플릿

```markdown
# {흐름명} 처리 흐름

> {핵심 요약 2-3줄}

## Entry Points
| 트리거 | 함수 | 파일 |
|--------|------|------|
| {언제} | `Class::Method()` | File.cpp:LINE |

## 흐름 요약
A → B → C → [분기] → D 또는 E

## 상세 호출 흐름
` ``
FunctionA()
  → FunctionB()                          # File.cpp:LINE - 설명
    → FunctionC()
      ├─ [조건 A] → FunctionD()          # 정상 경로
      └─ [조건 B] → FunctionE()          # 문제 경로
` ``

## 분기 조건
| 조건 | 결과 | 위치 |
|------|------|------|
| `expr == value` | 정상 ✅ | File.cpp:LINE |

## 디버깅 팁
- 브레이크포인트 추천: `File.cpp:LINE`
```

## 클래스 상세 템플릿

```markdown
# {ClassName}

> {핵심 요약 1-2줄}

## 역할과 위치
- 모듈: {모듈명}
- 부모: {ParentClass}
- 파일: {Header.h}, {Source.cpp}

## 주요 멤버
| 멤버 | 타입 | 설명 |
|------|------|------|

## 주요 메서드
| 메서드 | 설명 | 호출 시점 |
|--------|------|----------|

## 상세 동작
{메서드별 상세}

## 주의사항
- {함정, 주의할 점}
```

## 세션 워크플로우

**시작 시:**
1. `~/WorkHistory/_index.md` → 관련 주제 확인
2. 관련 `_index.md` → 핵심 요약으로 시스템 파악
3. 필요한 파일만 선택적 로드

**작업 중:**
4. 발견할 때마다 즉시 기록 (나중에 하면 잊음)
5. 모든 문서에 핵심 요약 필수

**완료 후:**
6. 새 주제면 `_index.md` 업데이트
7. 기존 문서 업데이트 반영

## 기록 기준 (하나라도 해당 시 즉시 기록)
- 새로운 클래스/함수/패턴 발견
- 기존 문서에 누락된 중요 정보 발견
- 효율적인 검색 키워드나 경로 발견
- 트러블슈팅 경험이나 해결책
- 코드 분석 결과 (클래스 관계, 함수 호출 흐름)

## 파일 생성 전 체크리스트 (재발 방지)

새 파일 생성 전 반드시 확인:

1. **기존 파일 확인**: 같은 주제의 파일이 이미 있는지 해당 시스템 폴더 전체 확인
   - 있으면 새 파일 만들지 말고 기존 파일에 추가/업데이트
   - 같은 주제의 분석 반복 시, 이전 결과를 덮어쓰거나 "## 추가 분석 (날짜)" 섹션 추가
2. **기존 폴더명 확인**: 새 폴더 만들기 전에 같은 시스템의 기존 폴더가 있는지 확인
   - `meshsurfaceimpact/`가 있으면 `msi/` 만들지 말것
3. **소속 시스템 폴더에 저장**: CSS 관련 → `css-pbb/`, MFX 관련 → `materialfx/`
   - 프로젝트 root에 시스템 소속 파일 놓지 말것
4. **한국어로 통일**: 모든 문서는 한국어 (코드/API명은 원문 유지)

## 명명 규칙

- **소문자 + 하이픈**: `pso-uv-fix.md` (O), `DynamicMeshAdapter_analysis.md` (X)
- **내용 기준 이름**: `cache-pipeline-to-component.md` (O), `task-001.md` (X)
- **Jira 티켓**: `P2-73208.md` (번호 자체가 식별자이므로 예외 허용)
- **날짜 접미사 지양**: `uv-analysis.md` (O), `uv-analysis-2026-02-09.md` (X)
  - 날짜는 파일 내부 상단에 기록
